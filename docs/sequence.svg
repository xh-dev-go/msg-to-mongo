<?xml version="1.0" encoding="UTF-8" ?><svg width="427.3056640625" height="286" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="-15 -41 427.3056640625 286"><metadata>title msg-to-mongo
begin broker , receiver, "Mongo" as mongo 
+receiver -&#62; +broker: check for new message
-broker --&#62; receiver:  message
receiver -&#62; +mongo: save message (queue data + outbox)
-receiver  &#60;-- -mongo: 

divider tear: 
+receiver -&#62; +broker: send outbox notificaton by outbox id
-broker --&#62;&#62; receiver: return response
receiver -&#62; +mongo: delete by outbox id
-mongo --&#62;&#62; -receiver: </metadata><defs></defs><defs><mask id="FullMask" maskUnits="userSpaceOnUse"><rect fill="#FFFFFF" height="286" width="427.3056640625" x="-15" y="-41"></rect><path d="M-10 126.80000000000001L-7 124.80000000000001L-4 126.80000000000001L-1 124.80000000000001L2 126.80000000000001L5 124.80000000000001L8 126.80000000000001L11 124.80000000000001L14 126.80000000000001L17 124.80000000000001L20 126.80000000000001L23 124.80000000000001L26 126.80000000000001L29 124.80000000000001L32 126.80000000000001L35 124.80000000000001L38 126.80000000000001L41 124.80000000000001L44 126.80000000000001L47 124.80000000000001L50 126.80000000000001L53 124.80000000000001L56 126.80000000000001L59 124.80000000000001L62 126.80000000000001L65 124.80000000000001L68 126.80000000000001L71 124.80000000000001L74 126.80000000000001L77 124.80000000000001L80 126.80000000000001L83 124.80000000000001L86 126.80000000000001L89 124.80000000000001L92 126.80000000000001L95 124.80000000000001L98 126.80000000000001L101 124.80000000000001L104 126.80000000000001L107 124.80000000000001L110 126.80000000000001L113 124.80000000000001L116 126.80000000000001L119 124.80000000000001L122 126.80000000000001L125 124.80000000000001L128 126.80000000000001L131 124.80000000000001L134 126.80000000000001L137 124.80000000000001L140 126.80000000000001L143 124.80000000000001L146 126.80000000000001L149 124.80000000000001L152 126.80000000000001L155 124.80000000000001L158 126.80000000000001L161 124.80000000000001L164 126.80000000000001L167 124.80000000000001L170 126.80000000000001L173 124.80000000000001L176 126.80000000000001L179 124.80000000000001L182 126.80000000000001L185 124.80000000000001L188 126.80000000000001L191 124.80000000000001L194 126.80000000000001L197 124.80000000000001L200 126.80000000000001L203 124.80000000000001L206 126.80000000000001L209 124.80000000000001L212 126.80000000000001L215 124.80000000000001L218 126.80000000000001L221 124.80000000000001L224 126.80000000000001L227 124.80000000000001L230 126.80000000000001L233 124.80000000000001L236 126.80000000000001L239 124.80000000000001L242 126.80000000000001L245 124.80000000000001L248 126.80000000000001L251 124.80000000000001L254 126.80000000000001L257 124.80000000000001L260 126.80000000000001L263 124.80000000000001L266 126.80000000000001L269 124.80000000000001L272 126.80000000000001L275 124.80000000000001L278 126.80000000000001L281 124.80000000000001L284 126.80000000000001L287 124.80000000000001L290 126.80000000000001L293 124.80000000000001L296 126.80000000000001L299 124.80000000000001L302 126.80000000000001L305 124.80000000000001L308 126.80000000000001L311 124.80000000000001L314 126.80000000000001L317 124.80000000000001L320 126.80000000000001L323 124.80000000000001L326 126.80000000000001L329 124.80000000000001L332 126.80000000000001L335 124.80000000000001L338 126.80000000000001L341 124.80000000000001L344 126.80000000000001L347 124.80000000000001L350 126.80000000000001L353 124.80000000000001L356 126.80000000000001L359 124.80000000000001L362 126.80000000000001L365 124.80000000000001L368 126.80000000000001L371 124.80000000000001L374 126.80000000000001L377 124.80000000000001L380 126.80000000000001L383 124.80000000000001L386 126.80000000000001L389 124.80000000000001L392 126.80000000000001L395 124.80000000000001L398 126.80000000000001L401 124.80000000000001L404 126.80000000000001L407.3056640625 131.8L404 132.8L401 130.8L398 132.8L395 130.8L392 132.8L389 130.8L386 132.8L383 130.8L380 132.8L377 130.8L374 132.8L371 130.8L368 132.8L365 130.8L362 132.8L359 130.8L356 132.8L353 130.8L350 132.8L347 130.8L344 132.8L341 130.8L338 132.8L335 130.8L332 132.8L329 130.8L326 132.8L323 130.8L320 132.8L317 130.8L314 132.8L311 130.8L308 132.8L305 130.8L302 132.8L299 130.8L296 132.8L293 130.8L290 132.8L287 130.8L284 132.8L281 130.8L278 132.8L275 130.8L272 132.8L269 130.8L266 132.8L263 130.8L260 132.8L257 130.8L254 132.8L251 130.8L248 132.8L245 130.8L242 132.8L239 130.8L236 132.8L233 130.8L230 132.8L227 130.8L224 132.8L221 130.8L218 132.8L215 130.8L212 132.8L209 130.8L206 132.8L203 130.8L200 132.8L197 130.8L194 132.8L191 130.8L188 132.8L185 130.8L182 132.8L179 130.8L176 132.8L173 130.8L170 132.8L167 130.8L164 132.8L161 130.8L158 132.8L155 130.8L152 132.8L149 130.8L146 132.8L143 130.8L140 132.8L137 130.8L134 132.8L131 130.8L128 132.8L125 130.8L122 132.8L119 130.8L116 132.8L113 130.8L110 132.8L107 130.8L104 132.8L101 130.8L98 132.8L95 130.8L92 132.8L89 130.8L86 132.8L83 130.8L80 132.8L77 130.8L74 132.8L71 130.8L68 132.8L65 130.8L62 132.8L59 130.8L56 132.8L53 130.8L50 132.8L47 130.8L44 132.8L41 130.8L38 132.8L35 130.8L32 132.8L29 130.8L26 132.8L23 130.8L20 132.8L17 130.8L14 132.8L11 130.8L8 132.8L5 130.8L2 132.8L-1 130.8L-4 132.8L-7 130.8L-10 132.8" fill="#000000"></path></mask><mask id="LineMask" maskUnits="userSpaceOnUse"><rect fill="#FFFFFF" height="286" width="427.3056640625" x="-15" y="-41"></rect><rect fill="#000000" height="11.4" width="90.0390625" x="71.3095703125" y="37.6"></rect><rect fill="#000000" height="11.4" width="38.4609375" x="97.0986328125" y="61.00000000000001"></rect><rect fill="#000000" height="11.4" width="138.30859375" x="208.1513671875" y="84.4"></rect><rect fill="#000000" height="11.4" width="133.64453125" x="49.5068359375" y="148.8"></rect><rect fill="#000000" height="11.4" width="62.03125" x="85.3134765625" y="172.20000000000002"></rect><rect fill="#000000" height="11.4" width="73.16015625" x="240.7255859375" y="195.60000000000002"></rect></mask><linearGradient id="tear-grad"><stop offset="1.1981625054701266%" stop-color="#000000"></stop><stop offset="3.5944875164103802%" stop-color="#FFFFFF"></stop><stop offset="96.40551248358962%" stop-color="#FFFFFF"></stop><stop offset="98.80183749452988%" stop-color="#000000"></stop></linearGradient><mask maskUnits="userSpaceOnUse" id="P1"><rect fill="url(#tear-grad)" height="16" width="417.3056640625" x="-10" y="120.80000000000001"></rect></mask></defs><g></g><g><text x="198.65283203125" class="title" font-family="Helvetica,Arial,Liberation Sans,sans-serif" font-size="20" line-height="1.3" text-anchor="middle" y="-16">msg-to-mongo</text></g><g><g class="region"><rect class="outline" fill="transparent" height="16" width="417.3056640625" x="-10" y="120.80000000000001"></rect><g mask="url(#P1)"><path d="M-10 126.80000000000001L-7 124.80000000000001L-4 126.80000000000001L-1 124.80000000000001L2 126.80000000000001L5 124.80000000000001L8 126.80000000000001L11 124.80000000000001L14 126.80000000000001L17 124.80000000000001L20 126.80000000000001L23 124.80000000000001L26 126.80000000000001L29 124.80000000000001L32 126.80000000000001L35 124.80000000000001L38 126.80000000000001L41 124.80000000000001L44 126.80000000000001L47 124.80000000000001L50 126.80000000000001L53 124.80000000000001L56 126.80000000000001L59 124.80000000000001L62 126.80000000000001L65 124.80000000000001L68 126.80000000000001L71 124.80000000000001L74 126.80000000000001L77 124.80000000000001L80 126.80000000000001L83 124.80000000000001L86 126.80000000000001L89 124.80000000000001L92 126.80000000000001L95 124.80000000000001L98 126.80000000000001L101 124.80000000000001L104 126.80000000000001L107 124.80000000000001L110 126.80000000000001L113 124.80000000000001L116 126.80000000000001L119 124.80000000000001L122 126.80000000000001L125 124.80000000000001L128 126.80000000000001L131 124.80000000000001L134 126.80000000000001L137 124.80000000000001L140 126.80000000000001L143 124.80000000000001L146 126.80000000000001L149 124.80000000000001L152 126.80000000000001L155 124.80000000000001L158 126.80000000000001L161 124.80000000000001L164 126.80000000000001L167 124.80000000000001L170 126.80000000000001L173 124.80000000000001L176 126.80000000000001L179 124.80000000000001L182 126.80000000000001L185 124.80000000000001L188 126.80000000000001L191 124.80000000000001L194 126.80000000000001L197 124.80000000000001L200 126.80000000000001L203 124.80000000000001L206 126.80000000000001L209 124.80000000000001L212 126.80000000000001L215 124.80000000000001L218 126.80000000000001L221 124.80000000000001L224 126.80000000000001L227 124.80000000000001L230 126.80000000000001L233 124.80000000000001L236 126.80000000000001L239 124.80000000000001L242 126.80000000000001L245 124.80000000000001L248 126.80000000000001L251 124.80000000000001L254 126.80000000000001L257 124.80000000000001L260 126.80000000000001L263 124.80000000000001L266 126.80000000000001L269 124.80000000000001L272 126.80000000000001L275 124.80000000000001L278 126.80000000000001L281 124.80000000000001L284 126.80000000000001L287 124.80000000000001L290 126.80000000000001L293 124.80000000000001L296 126.80000000000001L299 124.80000000000001L302 126.80000000000001L305 124.80000000000001L308 126.80000000000001L311 124.80000000000001L314 126.80000000000001L317 124.80000000000001L320 126.80000000000001L323 124.80000000000001L326 126.80000000000001L329 124.80000000000001L332 126.80000000000001L335 124.80000000000001L338 126.80000000000001L341 124.80000000000001L344 126.80000000000001L347 124.80000000000001L350 126.80000000000001L353 124.80000000000001L356 126.80000000000001L359 124.80000000000001L362 126.80000000000001L365 124.80000000000001L368 126.80000000000001L371 124.80000000000001L374 126.80000000000001L377 124.80000000000001L380 126.80000000000001L383 124.80000000000001L386 126.80000000000001L389 124.80000000000001L392 126.80000000000001L395 124.80000000000001L398 126.80000000000001L401 124.80000000000001L404 126.80000000000001" fill="none" stroke="#000000"></path><path d="M-10 132.8L-7 130.8L-4 132.8L-1 130.8L2 132.8L5 130.8L8 132.8L11 130.8L14 132.8L17 130.8L20 132.8L23 130.8L26 132.8L29 130.8L32 132.8L35 130.8L38 132.8L41 130.8L44 132.8L47 130.8L50 132.8L53 130.8L56 132.8L59 130.8L62 132.8L65 130.8L68 132.8L71 130.8L74 132.8L77 130.8L80 132.8L83 130.8L86 132.8L89 130.8L92 132.8L95 130.8L98 132.8L101 130.8L104 132.8L107 130.8L110 132.8L113 130.8L116 132.8L119 130.8L122 132.8L125 130.8L128 132.8L131 130.8L134 132.8L137 130.8L140 132.8L143 130.8L146 132.8L149 130.8L152 132.8L155 130.8L158 132.8L161 130.8L164 132.8L167 130.8L170 132.8L173 130.8L176 132.8L179 130.8L182 132.8L185 130.8L188 132.8L191 130.8L194 132.8L197 130.8L200 132.8L203 130.8L206 132.8L209 130.8L212 132.8L215 130.8L218 132.8L221 130.8L224 132.8L227 130.8L230 132.8L233 130.8L236 132.8L239 130.8L242 132.8L245 130.8L248 132.8L251 130.8L254 132.8L257 130.8L260 132.8L263 130.8L266 132.8L269 130.8L272 132.8L275 130.8L278 132.8L281 130.8L284 132.8L287 130.8L290 132.8L293 130.8L296 132.8L299 130.8L302 132.8L305 130.8L308 132.8L311 130.8L314 132.8L317 130.8L320 132.8L323 130.8L326 132.8L329 130.8L332 132.8L335 130.8L338 132.8L341 130.8L344 132.8L347 130.8L350 132.8L353 130.8L356 132.8L359 130.8L362 132.8L365 130.8L368 132.8L371 130.8L374 132.8L377 130.8L380 132.8L383 130.8L386 132.8L389 130.8L392 132.8L395 130.8L398 132.8L401 130.8L404 132.8" fill="none" stroke="#000000"></path></g></g></g><g mask="url(#FullMask)"><g mask="url(#LineMask)"><line fill="none" stroke="#000000" stroke-width="1" x1="195.6513671875" x2="195.6513671875" y1="25.6" y2="49" class="agent-2-line"></line><line fill="none" stroke="#000000" stroke-width="1" x1="37.0068359375" x2="37.0068359375" y1="25.6" y2="49" class="agent-1-line"></line><rect fill="none" stroke="#000000" stroke-width="1" height="23.400000000000006" width="8" x="33.0068359375" y="49" class="agent-1-line"></rect><line fill="none" stroke="#000000" stroke-width="1" x1="358.9599609375" x2="358.9599609375" y1="25.6" y2="95.80000000000001" class="agent-3-line"></line><rect fill="none" stroke="#000000" stroke-width="1" height="61.80000000000001" width="8" x="191.6513671875" y="49" class="agent-2-line"></rect><rect fill="none" stroke="#000000" stroke-width="1" height="15" width="8" x="354.9599609375" y="95.80000000000001" class="agent-3-line"></rect><line fill="none" stroke="#000000" stroke-width="1" x1="195.6513671875" x2="195.6513671875" y1="110.80000000000001" y2="160.20000000000002" class="agent-2-line"></line><line fill="none" stroke="#000000" stroke-width="1" x1="37.0068359375" x2="37.0068359375" y1="72.4" y2="160.20000000000002" class="agent-1-line"></line><rect fill="none" stroke="#000000" stroke-width="1" height="23.400000000000006" width="8" x="33.0068359375" y="160.20000000000002" class="agent-1-line"></rect><line fill="none" stroke="#000000" stroke-width="1" x1="358.9599609375" x2="358.9599609375" y1="110.80000000000001" y2="207.00000000000003" class="agent-3-line"></line><rect fill="none" stroke="#000000" stroke-width="1" height="13" width="8" x="354.9599609375" y="207.00000000000003" class="agent-3-line"></rect><rect fill="none" stroke="#000000" stroke-width="1" height="59.80000000000001" width="8" x="191.6513671875" y="160.20000000000002" class="agent-2-line"></rect><line fill="none" stroke="#000000" stroke-width="1" x1="37.0068359375" x2="37.0068359375" y1="183.60000000000002" y2="240.00000000000003" class="agent-1-line"></line><line fill="none" stroke="#000000" stroke-width="1" x1="195.6513671875" x2="195.6513671875" y1="220.00000000000003" y2="240.00000000000003" class="agent-2-line"></line><line fill="none" stroke="#000000" stroke-width="1" x1="358.9599609375" x2="358.9599609375" y1="220.00000000000003" y2="240.00000000000003" class="agent-3-line"></line></g><g></g><g><g class="region"><g><rect fill="#FFFFFF" stroke="#000000" stroke-width="1" height="25.6" width="54.013671875" x="10" y="0"></rect><g><text x="37.0068359375" font-family="Helvetica,Arial,Liberation Sans,sans-serif" font-size="12" line-height="1.3" text-anchor="middle" y="17">broker</text></g></g><rect class="outline" fill="transparent" height="25.6" width="54.013671875" x="10" y="0"></rect></g><g class="region"><g><rect fill="#FFFFFF" stroke="#000000" stroke-width="1" height="25.6" width="62.6796875" x="164.3115234375" y="0"></rect><g><text x="195.6513671875" font-family="Helvetica,Arial,Liberation Sans,sans-serif" font-size="12" line-height="1.3" text-anchor="middle" y="17">receiver</text></g></g><rect class="outline" fill="transparent" height="25.6" width="62.6796875" x="164.3115234375" y="0"></rect></g><g class="region"><g><rect fill="#FFFFFF" stroke="#000000" stroke-width="1" height="25.6" width="56.69140625" x="330.6142578125" y="0"></rect><g><text x="358.9599609375" font-family="Helvetica,Arial,Liberation Sans,sans-serif" font-size="12" line-height="1.3" text-anchor="middle" y="17">Mongo</text></g></g><rect class="outline" fill="transparent" height="25.6" width="56.69140625" x="330.6142578125" y="0"></rect></g><g class="region"><path d="M191.6513671875 49L44.0068359375 49" fill="none" stroke="#000000" stroke-width="1"></path><polygon points="46.5068359375 44 41.5068359375 49 46.5068359375 54" fill="#000000" stroke-width="0" stroke-linejoin="miter"></polygon><path class="outline" fill="transparent" d="M191.6513671875,35.6L41.0068359375,35.6L41.0068359375,54L191.6513671875,54Z"></path><g><text x="116.3291015625" font-family="Helvetica,Arial,Liberation Sans,sans-serif" font-size="8" line-height="1.3" text-anchor="middle" y="45.6">check for new message</text></g></g><g class="region"><path d="M41.0068359375 72.4L188.6513671875 72.4" fill="none" stroke="#000000" stroke-width="1" stroke-dasharray="4, 2"></path><polygon points="186.1513671875 77.4 191.1513671875 72.4 186.1513671875 67.4" fill="#000000" stroke-width="0" stroke-linejoin="miter"></polygon><path class="outline" fill="transparent" d="M41.0068359375,59.00000000000001L191.6513671875,59.00000000000001L191.6513671875,77.4L41.0068359375,77.4Z"></path><g><text x="116.3291015625" font-family="Helvetica,Arial,Liberation Sans,sans-serif" font-size="8" line-height="1.3" text-anchor="middle" y="69">message</text></g></g><g class="region"><path d="M199.6513671875 95.80000000000001L351.9599609375 95.80000000000001" fill="none" stroke="#000000" stroke-width="1"></path><polygon points="349.4599609375 100.80000000000001 354.4599609375 95.80000000000001 349.4599609375 90.80000000000001" fill="#000000" stroke-width="0" stroke-linejoin="miter"></polygon><path class="outline" fill="transparent" d="M199.6513671875,82.4L354.9599609375,82.4L354.9599609375,100.80000000000001L199.6513671875,100.80000000000001Z"></path><g><text x="277.3056640625" font-family="Helvetica,Arial,Liberation Sans,sans-serif" font-size="8" line-height="1.3" text-anchor="middle" y="92.4">save message (queue data + outbox)</text></g></g><g class="region"><path d="M202.6513671875 110.80000000000001L354.9599609375 110.80000000000001" fill="none" stroke="#000000" stroke-width="1" stroke-dasharray="4, 2"></path><polygon points="205.1513671875 105.80000000000001 200.1513671875 110.80000000000001 205.1513671875 115.80000000000001" fill="#000000" stroke-width="0" stroke-linejoin="miter"></polygon><path class="outline" fill="transparent" d="M199.6513671875,105.80000000000001L354.9599609375,105.80000000000001L354.9599609375,115.80000000000001L199.6513671875,115.80000000000001Z"></path></g><g class="region"><path d="M191.6513671875 160.20000000000002L44.0068359375 160.20000000000002" fill="none" stroke="#000000" stroke-width="1"></path><polygon points="46.5068359375 155.20000000000002 41.5068359375 160.20000000000002 46.5068359375 165.20000000000002" fill="#000000" stroke-width="0" stroke-linejoin="miter"></polygon><path class="outline" fill="transparent" d="M191.6513671875,146.8L41.0068359375,146.8L41.0068359375,165.20000000000002L191.6513671875,165.20000000000002Z"></path><g><text x="116.3291015625" font-family="Helvetica,Arial,Liberation Sans,sans-serif" font-size="8" line-height="1.3" text-anchor="middle" y="156.8">send outbox notificaton by outbox id</text></g></g><g class="region"><path d="M41.0068359375 183.60000000000002L189.98470052083334 183.60000000000002" fill="none" stroke="#000000" stroke-width="1" stroke-dasharray="4, 2"></path><polyline points="186.31803385416666 186.60000000000002 190.31803385416666 183.60000000000002 186.31803385416666 180.60000000000002" fill="none" stroke="#000000" stroke-width="1" stroke-linejoin="miter"></polyline><path class="outline" fill="transparent" d="M41.0068359375,170.20000000000002L191.6513671875,170.20000000000002L191.6513671875,186.60000000000002L41.0068359375,186.60000000000002Z"></path><g><text x="116.3291015625" font-family="Helvetica,Arial,Liberation Sans,sans-serif" font-size="8" line-height="1.3" text-anchor="middle" y="180.20000000000002">return response</text></g></g><g class="region"><path d="M199.6513671875 207.00000000000003L351.9599609375 207.00000000000003" fill="none" stroke="#000000" stroke-width="1"></path><polygon points="349.4599609375 212.00000000000003 354.4599609375 207.00000000000003 349.4599609375 202.00000000000003" fill="#000000" stroke-width="0" stroke-linejoin="miter"></polygon><path class="outline" fill="transparent" d="M199.6513671875,193.60000000000002L354.9599609375,193.60000000000002L354.9599609375,212.00000000000003L199.6513671875,212.00000000000003Z"></path><g><text x="277.3056640625" font-family="Helvetica,Arial,Liberation Sans,sans-serif" font-size="8" line-height="1.3" text-anchor="middle" y="203.60000000000002">delete by outbox id</text></g></g><g class="region"><path d="M354.9599609375 220.00000000000003L201.31803385416666 220.00000000000003" fill="none" stroke="#000000" stroke-width="1" stroke-dasharray="4, 2"></path><polyline points="204.98470052083334 217.00000000000003 200.98470052083334 220.00000000000003 204.98470052083334 223.00000000000003" fill="none" stroke="#000000" stroke-width="1" stroke-linejoin="miter"></polyline><path class="outline" fill="transparent" d="M354.9599609375,217.00000000000003L199.6513671875,217.00000000000003L199.6513671875,223.00000000000003L354.9599609375,223.00000000000003Z"></path></g><g class="region"><rect class="outline" fill="transparent" height="10" width="10" x="32.0068359375" y="230.00000000000003"></rect></g><g class="region"><rect class="outline" fill="transparent" height="10" width="10" x="190.6513671875" y="230.00000000000003"></rect></g><g class="region"><rect class="outline" fill="transparent" height="10" width="10" x="353.9599609375" y="230.00000000000003"></rect></g></g></g></svg>